\hypertarget{namespacequeries_1_1gets_1_1ledger}{}\doxysection{queries.\+gets.\+ledger Namespace Reference}
\label{namespacequeries_1_1gets_1_1ledger}\index{queries.gets.ledger@{queries.gets.ledger}}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{namespacequeries_1_1gets_1_1ledger_a16a0630590083ad1862ed9345d888147}{get\+\_\+transactions}} (st\+\_\+dt, end\+\_\+dt=dt.\+datetime.\+now())
\item 
def \mbox{\hyperlink{namespacequeries_1_1gets_1_1ledger_abe271b893d7ff70ec6d1f558ffae33a2}{get\+\_\+sells}} (dest, st\+\_\+dt, end\+\_\+dt=None)
\item 
def \mbox{\hyperlink{namespacequeries_1_1gets_1_1ledger_aaa66a8f003f1814d412cee4d7b3e6b80}{get\+\_\+last\+\_\+timestamp}} ()
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespacequeries_1_1gets_1_1ledger_aaa66a8f003f1814d412cee4d7b3e6b80}\label{namespacequeries_1_1gets_1_1ledger_aaa66a8f003f1814d412cee4d7b3e6b80}} 
\index{queries.gets.ledger@{queries.gets.ledger}!get\_last\_timestamp@{get\_last\_timestamp}}
\index{get\_last\_timestamp@{get\_last\_timestamp}!queries.gets.ledger@{queries.gets.ledger}}
\doxysubsubsection{\texorpdfstring{get\_last\_timestamp()}{get\_last\_timestamp()}}
{\footnotesize\ttfamily def queries.\+gets.\+ledger.\+get\+\_\+last\+\_\+timestamp (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\begin{DoxyVerb}retrieve the timestamp of the last transaction (CALLED FROM THE CLIENT SIDE)

@return timestamp
\end{DoxyVerb}
 

Definition at line 29 of file ledger.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{29 \textcolor{keyword}{def }\mbox{\hyperlink{namespacecore_1_1queries_1_1gets_1_1ledger_abf9951152629a9000fe5c98442590ab0}{get\_last\_timestamp}}():}
\DoxyCodeLine{30     \textcolor{stringliteral}{""" retrieve the timestamp of the last transaction (CALLED FROM THE CLIENT SIDE)}}
\DoxyCodeLine{31 \textcolor{stringliteral}{}}
\DoxyCodeLine{32 \textcolor{stringliteral}{    @return timestamp}}
\DoxyCodeLine{33 \textcolor{stringliteral}{    """}}
\DoxyCodeLine{34     query=\textcolor{stringliteral}{"SELECT currval(pg\_get\_serial\_sequence('ledger', 'trx\_id'));"}}
\DoxyCodeLine{35     db\_log.debug(query)}
\DoxyCodeLine{36     cur.execute(query)}
\DoxyCodeLine{37     \textcolor{keywordflow}{return} cur.fetchone()[0]}

\end{DoxyCode}
\mbox{\Hypertarget{namespacequeries_1_1gets_1_1ledger_abe271b893d7ff70ec6d1f558ffae33a2}\label{namespacequeries_1_1gets_1_1ledger_abe271b893d7ff70ec6d1f558ffae33a2}} 
\index{queries.gets.ledger@{queries.gets.ledger}!get\_sells@{get\_sells}}
\index{get\_sells@{get\_sells}!queries.gets.ledger@{queries.gets.ledger}}
\doxysubsubsection{\texorpdfstring{get\_sells()}{get\_sells()}}
{\footnotesize\ttfamily def queries.\+gets.\+ledger.\+get\+\_\+sells (\begin{DoxyParamCaption}\item[{}]{dest,  }\item[{}]{st\+\_\+dt,  }\item[{}]{end\+\_\+dt = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}get sells transaction within the st_dt, end_dt period, while there destined to dest (CALLED AT SERVER SIDE)
@param dest: the destination credential id
@return sells transactions
\end{DoxyVerb}
 

Definition at line 20 of file ledger.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{20 \textcolor{keyword}{def }\mbox{\hyperlink{namespacecore_1_1queries_1_1gets_1_1ledger_ae14b161205be95246f9dbf4e3170581a}{get\_sells}}(dest, st\_dt, end\_dt=None):}
\DoxyCodeLine{21     \textcolor{stringliteral}{""" get sells transaction within the st\_dt, end\_dt period, while there destined to dest (CALLED AT SERVER SIDE)}}
\DoxyCodeLine{22 \textcolor{stringliteral}{    @param dest: the destination credential id}}
\DoxyCodeLine{23 \textcolor{stringliteral}{    @return sells transactions}}
\DoxyCodeLine{24 \textcolor{stringliteral}{"""}}
\DoxyCodeLine{25     trx=\mbox{\hyperlink{namespacecore_1_1queries_1_1gets_1_1ledger_a48f7fc47aa39d3e7984fa01512758f0f}{get\_transactions}}(st\_dt, end\_dt).to\_json()}
\DoxyCodeLine{26     trx.apply(\textcolor{keyword}{lambda} x:x[\textcolor{stringliteral}{'trx\_dest'}]==dest, inplace=\textcolor{keyword}{True})}
\DoxyCodeLine{27     \textcolor{keywordflow}{return} trx}
\DoxyCodeLine{28 }

\end{DoxyCode}


References queries.\+gets.\+ledger.\+get\+\_\+transactions().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacequeries_1_1gets_1_1ledger_abe271b893d7ff70ec6d1f558ffae33a2_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacequeries_1_1gets_1_1ledger_a16a0630590083ad1862ed9345d888147}\label{namespacequeries_1_1gets_1_1ledger_a16a0630590083ad1862ed9345d888147}} 
\index{queries.gets.ledger@{queries.gets.ledger}!get\_transactions@{get\_transactions}}
\index{get\_transactions@{get\_transactions}!queries.gets.ledger@{queries.gets.ledger}}
\doxysubsubsection{\texorpdfstring{get\_transactions()}{get\_transactions()}}
{\footnotesize\ttfamily def queries.\+gets.\+ledger.\+get\+\_\+transactions (\begin{DoxyParamCaption}\item[{}]{st\+\_\+dt,  }\item[{}]{end\+\_\+dt = {\ttfamily dt.datetime.now()} }\end{DoxyParamCaption})}

\begin{DoxyVerb}get the transactions within the given period exclusively

@param st_dt: the start datetime
@param end_dt: the end datetime
@return dataframe of the transactions
\end{DoxyVerb}
 

Definition at line 7 of file ledger.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{7 \textcolor{keyword}{def }\mbox{\hyperlink{namespacecore_1_1queries_1_1gets_1_1ledger_a48f7fc47aa39d3e7984fa01512758f0f}{get\_transactions}}(st\_dt, end\_dt=dt.datetime.now()):}
\DoxyCodeLine{8     \textcolor{stringliteral}{""" get the transactions within the given period exclusively}}
\DoxyCodeLine{9 \textcolor{stringliteral}{}}
\DoxyCodeLine{10 \textcolor{stringliteral}{    @param st\_dt: the start datetime}}
\DoxyCodeLine{11 \textcolor{stringliteral}{    @param end\_dt: the end datetime}}
\DoxyCodeLine{12 \textcolor{stringliteral}{    @return dataframe of the transactions}}
\DoxyCodeLine{13 \textcolor{stringliteral}{    """}}
\DoxyCodeLine{14     stat = sql.SQL(\textcolor{stringliteral}{"SELECT * FROM ledger WHERE trx\_dt>\{st\_dt\} AND trx\_dt<\{end\_dt\};"}).\(\backslash\)}
\DoxyCodeLine{15         \mbox{\hyperlink{namespaceclient_1_1client_a28f28b5d621b127269d6035d7a435682}{format}}(st\_dt=sql.Literal(st\_dt), \(\backslash\)}
\DoxyCodeLine{16                end\_dt=sql.Literal(end\_dt))}
\DoxyCodeLine{17     db\_log.debug(stat)}
\DoxyCodeLine{18     \textcolor{keywordflow}{return} pd.read\_sql(conn, stat)}
\DoxyCodeLine{19 }

\end{DoxyCode}


References client.\+client.\+format.



Referenced by queries.\+gets.\+ledger.\+get\+\_\+sells().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacequeries_1_1gets_1_1ledger_a16a0630590083ad1862ed9345d888147_icgraph}
\end{center}
\end{figure}
