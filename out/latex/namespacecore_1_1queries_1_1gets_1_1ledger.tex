\hypertarget{namespacecore_1_1queries_1_1gets_1_1ledger}{}\doxysection{core.\+queries.\+gets.\+ledger Namespace Reference}
\label{namespacecore_1_1queries_1_1gets_1_1ledger}\index{core.queries.gets.ledger@{core.queries.gets.ledger}}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{namespacecore_1_1queries_1_1gets_1_1ledger_a5972eaad1358e7f2c679c0665b6888d4}{get\+\_\+transactions}} (st\+\_\+dt, end\+\_\+dt=dt.\+datetime.\+now())
\item 
def \mbox{\hyperlink{namespacecore_1_1queries_1_1gets_1_1ledger_a9154db587e273a74a72c6d8f557b7995}{get\+\_\+sells}} (dest, st\+\_\+dt, end\+\_\+dt=None)
\item 
def \mbox{\hyperlink{namespacecore_1_1queries_1_1gets_1_1ledger_a8455769de06bc3ac141cec1724e44f25}{get\+\_\+last\+\_\+timestamp}} ()
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespacecore_1_1queries_1_1gets_1_1ledger_a8455769de06bc3ac141cec1724e44f25}\label{namespacecore_1_1queries_1_1gets_1_1ledger_a8455769de06bc3ac141cec1724e44f25}} 
\index{core.queries.gets.ledger@{core.queries.gets.ledger}!get\_last\_timestamp@{get\_last\_timestamp}}
\index{get\_last\_timestamp@{get\_last\_timestamp}!core.queries.gets.ledger@{core.queries.gets.ledger}}
\doxysubsubsection{\texorpdfstring{get\_last\_timestamp()}{get\_last\_timestamp()}}
{\footnotesize\ttfamily def core.\+queries.\+gets.\+ledger.\+get\+\_\+last\+\_\+timestamp (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\begin{DoxyVerb}retrieve the timestamp of the last transaction (CALLED FROM THE CLIENT SIDE)

@return timestamp
\end{DoxyVerb}
 

Definition at line 29 of file ledger.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{29 \textcolor{keyword}{def }\mbox{\hyperlink{namespacecore_1_1queries_1_1gets_1_1ledger_a8455769de06bc3ac141cec1724e44f25}{get\_last\_timestamp}}():}
\DoxyCodeLine{30     \textcolor{stringliteral}{""" retrieve the timestamp of the last transaction (CALLED FROM THE CLIENT SIDE)}}
\DoxyCodeLine{31 \textcolor{stringliteral}{}}
\DoxyCodeLine{32 \textcolor{stringliteral}{    @return timestamp}}
\DoxyCodeLine{33 \textcolor{stringliteral}{    """}}
\DoxyCodeLine{34     query=\textcolor{stringliteral}{"SELECT currval(pg\_get\_serial\_sequence('ledger', 'trx\_id'));"}}
\DoxyCodeLine{35     db\_log.debug(query)}
\DoxyCodeLine{36     cur.execute(query)}
\DoxyCodeLine{37     \textcolor{keywordflow}{return} cur.fetchone()[0]}

\end{DoxyCode}
\mbox{\Hypertarget{namespacecore_1_1queries_1_1gets_1_1ledger_a9154db587e273a74a72c6d8f557b7995}\label{namespacecore_1_1queries_1_1gets_1_1ledger_a9154db587e273a74a72c6d8f557b7995}} 
\index{core.queries.gets.ledger@{core.queries.gets.ledger}!get\_sells@{get\_sells}}
\index{get\_sells@{get\_sells}!core.queries.gets.ledger@{core.queries.gets.ledger}}
\doxysubsubsection{\texorpdfstring{get\_sells()}{get\_sells()}}
{\footnotesize\ttfamily def core.\+queries.\+gets.\+ledger.\+get\+\_\+sells (\begin{DoxyParamCaption}\item[{}]{dest,  }\item[{}]{st\+\_\+dt,  }\item[{}]{end\+\_\+dt = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}get sells transaction within the st_dt, end_dt period, while there destined to dest (CALLED AT SERVER SIDE)
@param dest: the destination credential id
@return sells transactions
\end{DoxyVerb}
 

Definition at line 20 of file ledger.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{20 \textcolor{keyword}{def }\mbox{\hyperlink{namespacecore_1_1queries_1_1gets_1_1ledger_a9154db587e273a74a72c6d8f557b7995}{get\_sells}}(dest, st\_dt, end\_dt=None):}
\DoxyCodeLine{21     \textcolor{stringliteral}{""" get sells transaction within the st\_dt, end\_dt period, while there destined to dest (CALLED AT SERVER SIDE)}}
\DoxyCodeLine{22 \textcolor{stringliteral}{    @param dest: the destination credential id}}
\DoxyCodeLine{23 \textcolor{stringliteral}{    @return sells transactions}}
\DoxyCodeLine{24 \textcolor{stringliteral}{"""}}
\DoxyCodeLine{25     trx=\mbox{\hyperlink{namespacecore_1_1queries_1_1gets_1_1ledger_a5972eaad1358e7f2c679c0665b6888d4}{get\_transactions}}(st\_dt, end\_dt).to\_json()}
\DoxyCodeLine{26     trx.apply(\textcolor{keyword}{lambda} x:x[\textcolor{stringliteral}{'trx\_dest'}]==dest, inplace=\textcolor{keyword}{True})}
\DoxyCodeLine{27     \textcolor{keywordflow}{return} trx}
\DoxyCodeLine{28 }

\end{DoxyCode}


References core.\+queries.\+gets.\+ledger.\+get\+\_\+transactions().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecore_1_1queries_1_1gets_1_1ledger_a9154db587e273a74a72c6d8f557b7995_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacecore_1_1queries_1_1gets_1_1ledger_a5972eaad1358e7f2c679c0665b6888d4}\label{namespacecore_1_1queries_1_1gets_1_1ledger_a5972eaad1358e7f2c679c0665b6888d4}} 
\index{core.queries.gets.ledger@{core.queries.gets.ledger}!get\_transactions@{get\_transactions}}
\index{get\_transactions@{get\_transactions}!core.queries.gets.ledger@{core.queries.gets.ledger}}
\doxysubsubsection{\texorpdfstring{get\_transactions()}{get\_transactions()}}
{\footnotesize\ttfamily def core.\+queries.\+gets.\+ledger.\+get\+\_\+transactions (\begin{DoxyParamCaption}\item[{}]{st\+\_\+dt,  }\item[{}]{end\+\_\+dt = {\ttfamily dt.datetime.now()} }\end{DoxyParamCaption})}

\begin{DoxyVerb}get the transactions within the given period exclusively

@param st_dt: the start datetime
@param end_dt: the end datetime
@return dataframe of the transactions
\end{DoxyVerb}
 

Definition at line 7 of file ledger.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{7 \textcolor{keyword}{def }\mbox{\hyperlink{namespacecore_1_1queries_1_1gets_1_1ledger_a5972eaad1358e7f2c679c0665b6888d4}{get\_transactions}}(st\_dt, end\_dt=dt.datetime.now()):}
\DoxyCodeLine{8     \textcolor{stringliteral}{""" get the transactions within the given period exclusively}}
\DoxyCodeLine{9 \textcolor{stringliteral}{}}
\DoxyCodeLine{10 \textcolor{stringliteral}{    @param st\_dt: the start datetime}}
\DoxyCodeLine{11 \textcolor{stringliteral}{    @param end\_dt: the end datetime}}
\DoxyCodeLine{12 \textcolor{stringliteral}{    @return dataframe of the transactions}}
\DoxyCodeLine{13 \textcolor{stringliteral}{    """}}
\DoxyCodeLine{14     stat = sql.SQL(\textcolor{stringliteral}{"SELECT * FROM ledger WHERE trx\_dt>\{st\_dt\} AND trx\_dt<\{end\_dt\};"}).\(\backslash\)}
\DoxyCodeLine{15         \mbox{\hyperlink{namespaceclient_1_1client_a28f28b5d621b127269d6035d7a435682}{format}}(st\_dt=sql.Literal(st\_dt), \(\backslash\)}
\DoxyCodeLine{16                end\_dt=sql.Literal(end\_dt))}
\DoxyCodeLine{17     db\_log.debug(stat)}
\DoxyCodeLine{18     \textcolor{keywordflow}{return} pd.read\_sql(conn, stat)}
\DoxyCodeLine{19 }

\end{DoxyCode}


References client.\+client.\+format.



Referenced by core.\+queries.\+gets.\+ledger.\+get\+\_\+sells().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacecore_1_1queries_1_1gets_1_1ledger_a5972eaad1358e7f2c679c0665b6888d4_icgraph}
\end{center}
\end{figure}
